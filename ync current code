warning: in the working copy of '.gitignore', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'README.md', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'components/base.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'components/common/formula.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'components/common/text_block.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'configs/app.yaml', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'configs/enums.yaml', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'configs/llm.yaml', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'layout/engine.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'layout/params.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'layout/refine_params.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'layout/templates/grid_2x2.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'layout/templates/grid_3x3.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'layout/templates/hero_side.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'layout/templates/left3_right3.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'layout/templates/left4_right4.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'layout/templates/left_right.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'pipeline/build_plan.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'pipeline/json_utils.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'pipeline/llm/zhipu.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'pipeline/prompting.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'pipeline/run_llm1.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'pipeline/run_llm3.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'pipeline/validate_plan.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'prompts/json_repair.md', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'prompts/llm2_scene_draft.md', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'prompts/llm3_scene_layout.md', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'render/actions.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'render/plan_scene.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'render/registry.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'render/runtime_state.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'schema/scene_plan_models.py', LF will be replaced by CRLF the next time Git touches it
warning: in the working copy of 'tests/test_layout.py', LF will be replaced by CRLF the next time Git touches it
[1mdiff --git a/.gitignore b/.gitignore[m
[1mindex a8e9e68..ef27707 100644[m
[1m--- a/.gitignore[m
[1m+++ b/.gitignore[m
[36m@@ -25,10 +25,13 @@[m [mwheels/[m
 venv/[m
 ENV/[m
 env/[m
[32m+[m[32m.venv/[m
[32m+[m[32m.envrc[m
 [m
 # IDE[m
 .vscode/[m
 .idea/[m
[32m+[m[32m*.iml[m
 *.swp[m
 *.swo[m
 *~[m
[36m@@ -41,6 +44,14 @@[m [mThumbs.db[m
 media/[m
 partial_movie_files/[m
 *.log[m
[32m+[m[32mmanim.cfg[m
[32m+[m
[32m+[m[32m# Tooling caches / coverage[m
[32m+[m[32m.mypy_cache/[m
[32m+[m[32m.ruff_cache/[m
[32m+[m[32m.coverage[m
[32m+[m[32mhtmlcov/[m
[32m+[m[32m.pytest_cache/[m
 [m
 # Environment[m
 .env[m
[1mdiff --git a/README.md b/README.md[m
[1mindex 24511c5..8da6a9a 100644[m
[1m--- a/README.md[m
[1m+++ b/README.md[m
[36m@@ -63,7 +63,7 @@[m [mpython -m pipeline.run_llm3 --case cases/demo_001 --no-repair[m
 å¸ƒå±€è¯´æ˜ï¼š[m
 [m
 - LLM2 éœ€åœ¨å¯¹è±¡ `style` ä¸­ç»™å‡º `size_level`ï¼ˆS/M/L/XLï¼‰[m
[31m-- LLM3 å¯åœ¨ `layout.params` ä¸­ç»™å‡ºæ¨¡æ¿å‚æ•°ï¼ˆå¦‚ `left_ratio` / `row_weights`ï¼‰[m
[32m+[m[32m- LLM3 ä»…å¯åœ¨ `layout.params` ä¸­ç»™å‡º `slot_scales`ï¼ˆæŒ‰ slot å•ç‹¬ç¼©æ”¾å®½é«˜ï¼‰[m
 - æ¸²æŸ“æ—¶é‡‡ç”¨â€œLLM åˆç¨¿ + çœŸå®æµ‹é‡å¾®è°ƒâ€æ··åˆç­–ç•¥ï¼ˆé»˜è®¤Â±10%å¾®è°ƒï¼Œæœ€å° slot å®½é«˜ 10% å±å¹•ï¼‰[m
 [m
 ## æ ¡éªŒï¼ˆå¯è‡ªåŠ¨ä¿®å¤ï¼‰[m
[1mdiff --git a/cases/demo_001/explanation.txt b/cases/demo_001/explanation.txt[m
[1mindex cd14bc6..c65513f 100644[m
[1m--- a/cases/demo_001/explanation.txt[m
[1m+++ b/cases/demo_001/explanation.txt[m
[36m@@ -1,18 +1,6 @@[m
[31m-[KNOWN][m
[31m-- æ–¹ç¨‹ï¼šx + 2 = 5[m
[31m-[m
[31m-[GOAL][m
[31m-- æ±‚è§£å˜é‡ x çš„å€¼ã€‚[m
[31m-[m
[31m-[PLAN][m
[31m-1. å°†æ–¹ç¨‹ä¸¤è¾¹åŒæ—¶å‡å» 2[m
[31m-2. ç®€åŒ–æ–¹ç¨‹å¾—åˆ° x çš„å€¼[m
[31m-3. éªŒè¯ç»“æœæ˜¯å¦æ­£ç¡®[m
[31m-[m
[31m-[DIAGRAM][m
[31m-- ä¸éœ€è¦ç”»å›¾[m
[31m-[m
[31m-[STEPS][m
[31m-1. ä»æ–¹ç¨‹ x + 2 = 5 ä¸¤è¾¹åŒæ—¶å‡å» 2[m
[31m-2. ç®€åŒ–å¾—åˆ° x = 3[m
[31m-3. éªŒè¯ï¼šå°† x = 3 ä»£å…¥åŸæ–¹ç¨‹ï¼Œ3 + 2 = 5ï¼ŒéªŒè¯æ­£ç¡®[m
[32m+[m[32m1. æ±‚ç¢°å‰é€Ÿåº¦v_P0ï¼šPä»Aä¸‹æ»‘åˆ°Bï¼Œæœºæ¢°èƒ½å®ˆæ’mgh=1/2 mv^2ï¼Œå¾—v_B=âˆš(2gh)=âˆš50â‰ˆ7.07m/sã€‚åœ¨ç²—ç³™æ®µBCï¼Œå—æ‘©æ“¦åŠ›f=Î¼mgï¼ŒåšåŠŸW_f=-Î¼mgLã€‚åŠ¨èƒ½å®šç†ï¼š1/2 mv_B^2 - Î¼mgL = 1/2 mv_P0^2ã€‚ä»£å…¥æ•°æ®ï¼š25 - 0.25*10*4 = 0.5*v_P0^2ï¼Œè§£å¾—v_P0=âˆš30â‰ˆ5.48m/sã€‚[m
[32m+[m[32m2. ç¢°æ’åˆ†æï¼šPä¸Qå‘ç”Ÿå¼¹æ€§ç¢°æ’ã€‚åŠ¨é‡å®ˆæ’ï¼šm1v_P0 = m1v_P1 + m2v_Q1ã€‚èƒ½é‡å®ˆæ’ï¼š1/2 m1v_P0^2 = 1/2 m1v_P1^2 + 1/2 m2v_Q1^2ã€‚ä»£å…¥m1=1kg, m2=3kg, v_P0=âˆš30ã€‚è§£å¾—v_P1 = (m1-m2)v_P0/(m1+m2) = -0.5âˆš30 (å‘å·¦)ï¼Œv_Q1 = 2m1v_P0/(m1+m2) = 0.5âˆš30 (å‘å³)ã€‚[m
[32m+[m[32m3. å¼¹ç°§æœ€å¤§å‹ç¼©é‡ï¼šQå‹ç¼©å¼¹ç°§ï¼Œæœºæ¢°èƒ½å®ˆæ’ã€‚1/2 m2 v_Q1^2 = 1/2 k x_max^2ã€‚ä»£å…¥ï¼š0.5*3*(0.5âˆš30)^2 = 0.5*300*x_max^2ã€‚è®¡ç®—å¾— x_max = 0.15mã€‚[m
[32m+[m[32m4. Qè¿åŠ¨æ—¶é—´ï¼šQä»Cå‡ºå‘å‹ç¼©å¼¹ç°§å†è¿”å›Cï¼Œç»å†åŠä¸ªå‘¨æœŸã€‚T = 2Ï€âˆš(m2/k) = 2Ï€âˆš(3/300) = 2Ï€/10 â‰ˆ 0.628sã€‚Î”t = T/2 = Ï€/10 â‰ˆ 0.314sã€‚[m
[32m+[m[32m5. è¿½åŠåˆ¤æ–­ï¼šç¢°æ’åPå‘å·¦å‡é€Ÿï¼ŒåŠ é€Ÿåº¦a_P = Î¼g = 2.5m/s^2ã€‚t=0æ—¶Påœ¨Cï¼Œé€Ÿåº¦v_P1=-âˆš30/2ã€‚Qè¿”å›Cæ—¶t=Ï€/10ï¼Œæ­¤æ—¶Pçš„é€Ÿåº¦v_P(t) = v_P1 + a_P t = -âˆš30/2 + 2.5*(Ï€/10) â‰ˆ -2.74 + 0.785 = -1.955m/s (ä»å‘å·¦)ã€‚Pçš„ä½ç§»x_P = v_P1 t + 0.5 a_P t^2 â‰ˆ -0.86mã€‚Qå›åˆ°Cåå‘å·¦è¿›å…¥ç²—ç³™æ®µï¼ŒåŠ é€Ÿåº¦a_Q = Î¼g = 2.5m/s^2ã€‚ç›¸å¯¹è¿åŠ¨ï¼šPåœ¨å‰(å·¦)ï¼ŒQåœ¨å(å³)ï¼ŒåŒå‘è¿åŠ¨ã€‚ç›¸å¯¹åˆé€Ÿåº¦Î”v = v_Q - v_P = 0 - (-1.955) = 1.955m/sã€‚ç›¸å¯¹åŠ é€Ÿåº¦Î”a = a_Q - a_P = 0ã€‚è¿½åŠæ—¶é—´Î”t' = |x_P| / Î”v â‰ˆ 0.86 / 1.955 â‰ˆ 0.44sã€‚æ­¤æ—¶Qè¿åŠ¨è·ç¦»x_Q = 0.5 a_Q (Î”t')^2 â‰ˆ 0.24mã€‚æ•…åœ¨è·Cç‚¹0.24må¤„ç›¸é‡ã€‚ç›¸é‡æ—¶é€Ÿåº¦v_P' = v_P + a_P Î”t' â‰ˆ -1.955 + 2.5*0.44 â‰ˆ -0.86m/sï¼Œv_Q' = a_Q Î”t' â‰ˆ 1.1m/sã€‚[m
[32m+[m[32m6. æœ€ç»ˆåœæ­¢ä½ç½®ï¼šPä»Cç‚¹å¼€å§‹å‘å·¦æ»‘è¡Œï¼Œæ€»åŠ¨èƒ½E_P = 1/2 m1 v_P1^2 = 3.75Jã€‚å…‹æœæ‘©æ“¦åšåŠŸW = Î¼ m1 g s_Pã€‚s_P = E_P / (Î¼ m1 g) = 3.75 / 2.5 = 1.5mã€‚æ•…Påœåœ¨è·Bç‚¹L - s_P = 4.0 - 1.5 = 2.5må¤„ã€‚Qä»Cç‚¹å¼€å§‹å‘å·¦æ»‘è¡Œï¼Œæ€»åŠ¨èƒ½E_Q = 1/2 m2 v_Q1^2 = 11.25Jã€‚s_Q = E_Q / (Î¼ m2 g) = 11.25 / 7.5 = 1.5mã€‚æ•…Qåœåœ¨è·Bç‚¹L - s_Q = 4.0 - 1.5 = 2.5må¤„ã€‚[m
[1mdiff --git a/cases/demo_001/llm2_raw.txt b/cases/demo_001/llm2_raw.txt[m
[1mindex 8b13789..de5ba48 100644[m
[1m--- a/cases/demo_001/ll